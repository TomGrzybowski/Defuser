"use strict";var game=document.querySelector(".defuser__game"),inputs=document.querySelectorAll("input"),rows=Number(document.querySelector("#defuser__rows").value),cols=Number(document.querySelector("#defuser__cols").value),bombsAmount=Number(document.querySelector("#defuser__bombs").value),selectRows=document.querySelectorAll(".defuser__row"),playButton=document.querySelector("#defuser__play"),hiders=document.querySelectorAll(".unrevealed"),cellsObj={},backdrop=document.querySelector(".backdrop"),victoryScreen=document.querySelector(".victory"),defeatScreen=document.querySelector(".defeat"),closeBtn=document.querySelector(".close-btn"),won=!1,bombsLeft=bombsAmount;function hideHider(e){var t=e.target;if("unrevealed"===t.classList[0]){t.classList.add("is-hidden");var s=t.parentElement;if(isBomb(s))return void lost(s);var o=Number(s.classList[1].split("-")[1]),r=Number(s.closest(".defuser__row").classList[1].split("-")[1]);cellsObj["cell-".concat(r,"-").concat(o)]=!0,""===s.textContent&&revealNearEmpty(s),checkWinCondition()&&win()}}function closeModal(){backdrop.classList.add("is-hidden"),victoryScreen.classList.add("is-hidden"),defeatScreen.classList.add("is-hidden"),won||setup(),won&&(won=!1)}function revealNearEmpty(e){for(var t=Number(e.classList[1].split("-")[1]),s=Number(e.closest(".defuser__row").classList[1].split("-")[1]),o=s-1;o<=s+1;o++)if(!(o<1||o>rows))for(var r=t-1;r<=t+1;r++)if(!(r<1||r>cols||r===t&&o===s)){var c=document.querySelector(".row-".concat(o," > .col-").concat(r)),n=c.childNodes[0].textContent;cellsObj["cell-".concat(o,"-").concat(r)]=!0,c.childNodes[1].classList.contains("is-hidden")||(c.childNodes[1].classList.add("is-hidden"),""===n&&revealNearEmpty(c))}}function checkWinCondition(){return Object.values(cellsObj).every((function(e){return!0===e}))}function lost(e){e.style.backgroundColor="red",backdrop.classList.remove("is-hidden"),defeatScreen.classList.remove("is-hidden")}function win(){won=!0,backdrop.classList.remove("is-hidden"),victoryScreen.classList.remove("is-hidden")}function isBomb(e){return!!(e.firstChild.firstChild&&Number(e.textContent)<1)}function flager(e){var t=e.target;if(e.preventDefault(),"unrevealed"===t.classList[0]){var s=document.createElement("i");s.classList.add("fa-solid"),s.classList.add("fa-flag"),t.append(s),bombsLeft-=1,updateBombsLeft()}else"fa-question"===t.classList[1]?(e.preventDefault(),t.parentElement.innerHTML=""):"fa-flag"===t.classList[1]&&(e.preventDefault(),t.classList.add("fa-question"),t.classList.remove("fa-flag"),bombsLeft+=1,updateBombsLeft())}function updateBombsLeft(){var e=document.querySelector(".defuser__bomb_counter_span");e.textContent=bombsLeft>0?bombsLeft:0}function handleUpdate(){rows=document.querySelector("#defuser__rows").value,cols=document.querySelector("#defuser__cols").value,bombsAmount=document.querySelector("#defuser__bombs").value}function createGrid(){var e=document.createElement("div");e.classList.add("defuser__header");var t=document.createElement("p");t.classList.add("defuser__bomb_counter"),t.textContent="Bombs left: ";var s=document.createElement("span");s.classList.add("defuser__bomb_counter_span"),s.textContent="".concat(bombsLeft),t.append(s),e.append(t),game.append(e);for(var o=1;o<=rows;o++){var r=document.createElement("div");r.classList.add("defuser__row"),r.classList.add("row-"+o),game.append(r);for(var c=1;c<=cols;c++){var n=document.createElement("div");n.classList.add("defuser__cell"),n.classList.add("col-"+c),cellsObj["cell-".concat(o,"-").concat(c)]=!1,r.append(n);var a=document.createElement("span");a.classList.add("defuser__cell_content"),n.append(a);var d=document.createElement("div");d.classList.add("unrevealed"),n.append(d)}}}function insertBombs(){for(var e=new Set;e.size<bombsAmount;){var t=Math.floor(Math.random()*rows)+1,s=Math.floor(Math.random()*cols)+1;e.add("".concat(t," - ").concat(s)),delete cellsObj["cell-".concat(t,"-").concat(s)]}bombsLeft=e.size,updateBombsLeft(),e.forEach((function(e){var t=document.createElement("i");t.classList.add("fa-solid"),t.classList.add("fa-bomb");var s=e.split(" - ");document.querySelector(".row-"+s[0]).querySelector(".col-"+s[1]).firstChild.append(t)}))}function iterateNearBombs(e,t){for(var s=e-1;s<=e+1;s++)if(!(s<1||s>rows))for(var o=t-1;o<=t+1;o++)if(!(o<1||o>cols||o===t&&s===e)){var r=document.querySelector(".row-".concat(s," > .col-").concat(o)),c=r.childNodes[0].textContent;isBomb(r)||(r.childNodes[0].textContent=""===c?1:String(Number(r.childNodes[0].textContent)+1))}}function numbersSetup(){document.querySelectorAll(".defuser__cell").forEach((function(e){if(isBomb(e)){var t=Number(e.classList[1].split("-")[1]);iterateNearBombs(Number(e.closest(".defuser__row").classList[1].split("-")[1]),t)}}))}function checkSettings(){var e=Number(document.querySelector("#defuser__rows").max),t=Number(document.querySelector("#defuser__cols").max),s=Number(document.querySelector("#defuser__bombs").max);return bombsAmount>rows*cols-1||(rows>e||cols>t||bombsAmount>s||(0>rows||0>cols||0>bombsAmount))}function setup(){if(game.innerHTML="",checkSettings(),checkSettings())return alert("Current settings do not allow to setup a game. Please Try adjusting the board size or amount of bombs."),void(game.textContent="Current settings do not allow to setup a game. Please Try adjusting the board size or amount of bombs.");createGrid(),insertBombs(),numbersSetup()}game.addEventListener("click",hideHider),game.addEventListener("contextmenu",flager),closeBtn.addEventListener("click",closeModal),inputs.forEach((function(e){e.addEventListener("change",handleUpdate)})),playButton.addEventListener("click",setup),setup();
//# sourceMappingURL=index.7a85b0ef.js.map
